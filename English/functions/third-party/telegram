#!/bin/bash

# Telegram
function telegram {
eval `resize` 
exitstatus=$?
if [ $exitstatus = 0 ]; then
    status="0"
    while [ "$status" -eq 0 ]  
    do
       
        VERSION=$(whiptail \
        --title "Telegram" --radiolist \
        "Which version of Chrome would you like to install?" \
        --ok-button "Install" \
        --cancel-button "Go Back" \
        $LINES $COLUMNS $(( $LINES - 12 )) \
        "stable"    "Stable builds" ON \
        "dev"       "Dev builds" OFF \
        3>&1 1>&2 2>&3) 
         
        # Change to lower case and remove spaces.
        case "${VERSION}" in
            stable) 
                show_info 'Downloading Telegram...'
                # Download Debian file that matches system architecture
                case `uname -i` in
                    i386|i486|i586|i686)
                        curl -O https://updates.tdesktop.com/tlinux32/tsetup32.0.9.18.tar.xz
                        ;;
                    x86_64)
                        curl -O https://updates.tdesktop.com/tlinux/tsetup.0.9.18.tar.xz
                        ;;
                    *)
                        show_error "No packages available to download that matches your system." && thirdparty
                        ;;
                esac
                
                tar xzvf /Telegram
                
                cd /Telegram; wget https://tlgrm.ru/files/locales/tdesktop/Russian.strings 
                
                # Install lang(s)
                
                
                # Install package(s)
                echo 'Installing Telegram...'
                show_warning 'Requires root privileges'
sudo mv Telegram /opt/telegram
sudo ln -sf /opt/telegram /usr/bin/telegram
                # Cleanup and finish
                rm tsetup*.tar.xz
                # Done
                show_success 'Done.'
                whiptail --title "Finished" --msgbox "Installation complete." 8 78
                status=1
                thirdparty
            ;;
            dev) 
                show_info 'Downloading Telegram (beta)...'
                # Download Debian file that matches system architecture
                case `uname -i` in
                    i386|i486|i586|i686)
                        curl -O https://dl.google.com/linux/direct/google-chrome-beta_current_i386.deb
                        ;;
                    x86_64)
                        curl -O https://dl.google.com/linux/direct/google-chrome-beta_current_amd64.deb
                        ;;
                    *)
                        show_error "No packages available to download that matches your system." && thirdparty
                        ;;
                esac
                # Install package(s)
                echo 'Installing Google Chrome...'
                show_warning 'Requires root privileges'
                sudo dpkg -i google-chrome*.deb
                sudo apt-get install -fy
                # Cleanup and finish
                rm google-chrome*.deb
                # Done
                show_success 'Done.'
                whiptail --title "Finished" --msgbox "Installation complete." 8 78
                status=1
                thirdparty
            ;;
        esac
        exitstatus1=$status1
    done
else
    clear && thirdparty
fi
}
